<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Kaete qUnits Tests</title>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<link rel="stylesheet" href="http://code.jquery.com/qunit/git/qunit.css" type="text/css" media="screen" />
<script type="text/javascript" src="http://code.jquery.com/qunit/git/qunit.js"></script>
<script type="text/javascript" src="kaete/kaete.js"></script>
<script>
$(function() {

    module("Text-only Templates");

    test("One line", function() {
        var template = "This is a text-only template.";
        equals(template, Kaete.render(template));
    });

    test("Multi-line", function() {
        var template = "\n\nI love Kaete\n\nIt is truly amazing.\n";
        equals(template, Kaete.render(template));
    });

    test("Containing HTML", function() {
        var template = "<h1>Hi, mom!</h1>\n";
        equals(template, Kaete.render(template));
    });


    module("Variable Tag");

    test("One variable", function() {
        var template = "[[ name ]]";
        var context = {name: "Bernard"};
        equals("Bernard", Kaete.render(template, context));
    });

    test("One variable with padded text", function() {
        var template = "All aboard the [[ vessel ]].";
        var context = {vessel: "sailboat"};
        equals("All aboard the sailboat.", Kaete.render(template, context));
    });

    test("A JavaScript expression", function() {
        var template = "Did you know that 1 + 2 = [[ 1 + 2 ]]?";
        equals("Did you know that 1 + 2 = 3?", Kaete.render(template));
    });

    test("Numerous variables", function() {
        var template = '"[[ noun ]] [[ verb ]] [[ adjective ]] [[ plural_noun ]][[ full_stop ]]"';
        var context = {noun: "Bob", verb: "likes", adjective: "small", plural_noun: "dogs", full_stop: "."};
        equals('"Bob likes small dogs."', Kaete.render(template, context));
    });

    test("Escaped/Unescaped variables", function() {
        var template = '[[ greeting ]]';
        var template_unescaped = '[[* greeting ]]';
        var context = {greeting: '<h1>Hi, mom!</h1>'};
        equals('&#60;h1&#62;Hi, mom!&#60;&#47;h1&#62;', Kaete.render(template, context));
        equals('<h1>Hi, mom!</h1>', Kaete.render(template_unescaped, context));
    });


    module("Code Tag");

    test("Set and print a variable", function() {
        var template = 'code="[% var test = "Hello, World!" %]", var="[[ test ]]"';
        equals('code="", var="Hello, World!"', Kaete.render(template));
    });

    test("Looping", function() {
        var template = "I like to count. [% for (var num = 1; num < 10; num++) { %][[ num ]][% } %]!";
        equals('I like to count. 123456789!', Kaete.render(template));
    });


});
</script>

</head>
<body>
    <h1 id="qunit-header">QUnit example</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">test markup, will be hidden</div>
</body>
</html>